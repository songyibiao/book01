# 直流电机与电机驱动TB6612FNG

> 本节讲解直流电机的结构、原理、实物接线方法，以及减速器的作用，并在最后说明了使用直流电机驱动芯片TB6612FNG控制直流电机的方法。

### （一）直流电机的结构

直流电动机的基本构造包括“电枢”、“场磁铁”、“集电环”、“电刷”。

> 1. **电枢**：可以绕轴心转动的软铁芯缠绕多圈线圈。
2. **场磁铁**：产生磁场的强力永久磁铁或电磁铁。
3. **集电环**：线圈约两端接至两片半圆形的集电环，随线圈转动，可供改变电流方向的变向器。每转动半圈（180度），线圈上的电流方向就改变一次。
4. **电刷**：通常使用碳制成，集电环接触固定位置的电刷，用以接至电源。

### （二）直流电机的原理

![](/img/Electric_motor_cycle_1.png)

此为一个简单的直流电（D.C.）电动机。当线圈通电后，转子周围产生磁场，转子的左侧被推离左侧的磁铁，并被吸引到右侧，从而产生转动。[^1]

![](/img/Electric_motor_cycle_2.png)

转子依靠惯性继续转动。

![](/img/Electric_motor_cycle_3.png)

当转子运行至水平位置时电流变换器将线圈的电流方向逆转，线圈所产生的磁场亦同时逆转，使这一过程得以重复。

### （三）减速器

减速器，又称减速箱，通常应用在低转速大扭矩的传动设备，把原电机高速运转的动力（每分钟几千上万转），通过减速器输入轴上的齿数少的齿轮啮合输出轴上齿轮大的齿轮，来达到减速的目的。大小齿轮的齿数之比就是传动比。减速器在执行机构之间起匹配转速和传递转矩的作用，是一种相对精密的机械，使用它的目的是降低转速和增加转矩。

减速器种类繁多，按传动和结构特点划分，减速器种类有齿轮减速器（Gear reducer）、蜗杆减速器（Worm wheel reducer）、蜗杆齿轮减速器及齿轮-蜗杆减速器、行星齿轮减速器(Planetary gears)、摆线针轮减速器（Cycloid reducer）和谐波齿轮减速器(Harmonic drive)等。

| ![](/img/motor1.png) |
| :--: |

齿轮减速器体积较小，传递扭矩大，但是有一定的回程间隙。

| ![](/img/motor2.png) |
| :--: |

蜗杆减速器的主要特点是具有反向自锁功能，可以有较大的减速比，但是一般体积较大，传动效率不高，精度不高。

![](/img/motor3.png)

行星减速器的主要特点是结构紧凑，回程间隙小、精度较高，使用寿命很长，额定输出扭矩可以做得很大，但价格昂贵。

下面是TTM1直流减速电机——一款搭配齿轮减速器的电机。

![](/img/TTM1-MOTOR.jpg)

黄色部分为减速箱，减速箱与电机直接联接，电机上的电路板为编码器。

## （四）电机实物接线图

具体到我们的电机，我们可以看看电机后面的图解。

<img src="/img/TTM1-MOTOR2.jpg" align="center">

你可以会产生疑问——直流电机不是只引出两根电机线吗？怎么这个电机有6根线？而且还有两个大焊点？其实，根据上面的图解也知道，那两个大焊点分别与两边的两根线是连接在一起的。也就是说这6根线，中间的4根线是编码器的线，只是用于测速，和直流电机本身没有联系。我们在进行开环控制的时候无需使用。

综上所述，我们只需要控制施加在电机线两端的直流电压大小和极性即可实现控制转速和方向。

## （五）TB6612FNG的使用方法

单片机的IO引脚的输出电流小，负载能力弱，我们无法直接通过单片机控制直流电机的转速和换向。直流电机是大电流感性负载，通常在单片机和电机之间添加一个功率放大器件来驱动直流电机。

在这里，我们使用电机驱动芯片——TB6612FNG来进行讲解。

TB6612FNG是东芝半导体公司生产的一款直流电机驱动器件，具有大电流MOSFET-H桥结构，双通道电流输出，可以同时驱动两个电机。也许大家更熟悉的是L298N，其实这两者的使用基本一致。相比L298N的热耗性和外围二极管续流电流，TB6612FNG不用外加散热片，外围电路简单，只需外接电源滤波电容就可以直接驱动电机，有利于减小电路板尺寸。对于PWM信号输入频率范围，高大100kHz的频率更是足以满足我们大部分的需求了。

以下是TB6612FNG的主要参数

TB6612FNG电机驱动芯片的主要特性如下：
a)	驱动电压：最大支持15V
b)	输出电流：1.2A（连续）/ 3.2A（峰值）
c)	工作模式：支持正转/反转/刹车/停止四种模式
d)	封装尺寸：SSOP24，0.65mm引脚间距

TB6612FNG内部集成两组H桥驱动电路，能直接驱动两个直流电机。TB6612FNG内部框图如下图所示。

以下是TB6612FNG模块测试一个电机的接线图

![](/img/TTM1-MOTOR3.jpg)

VM直接接电池即可，VCC是内部的逻辑供电，给3.3或5V都行，模块的3个GND接任意一个即可，因为内部都是导通的，STBY置高模块才能正常工作。

完成上面的接线之后，我们就可以开始控制电机了，上图中红色部分的5个引脚控制一路电机，蓝色部分的控制另外一路电机，这里讲其中的A路，B路的使用的一样的。AO1和AO2分别别到电机的+和-，然后通过PWMA、AIN1、AIN2控制电机。其中PWMA接到单片机的PWM引脚，一般10Khz的PWM即可，并通过改变占空比来调节电机的速度。下面是真值表：

AIN1|0|1|0|
:--:|:--:|:--:|:--:
AIN2|0|0|1
|停止|正转|反转

### （六）TB6612FNG驱动电机的方法

下面介绍一种最简单直接的用TB6612FNG测试电机转动的方法：

> **按照以下方式接线：**
> 
> VM直接接电池正极（注意电压务不能超过15V）；
> 
> 当AIN1接3.3~5V、AIN2接GND、PWMA接3.3~5V，这样相当于控制电机满占空比正转；
> 
> 当AIN1接GND、AIN2接3.3V~5V、PWMA接3.3~5V，这样相当于控制电机满占空比反转。

___

> [^1]: 由Wapcaplet - Created by Wapcaplet in Blender.http://en.wikipedia.org/wiki/Image:Electric_motor_cycle_1.png，CC BY-SA 3.0，https://commons.wikimedia.org/w/index.php?curid=671789